---
- name: servers host setup
  when: ("servers" in group_names)
  include_role:
    name: "{{ item }}"
  loop:
    - core-security
    - core-journalctl
    - mon-bot-disc-space
    - cln-disc-space
    - mon-bot-btrfs
    - maint-btrfs-auto-balancer

- name: "Integrate Docker Role includes"
  include_tasks: "./tasks/utils/web-app-roles.yml"

# Native Webserver Roles
- name: setup web-svc-htmls
  include_role:
    name: web-svc-html
  vars:
    domain: "{{primary_domain}}"
  when: ('web-svc-htmls' | application_allowed(group_names, allowed_applications))

- name: "setup corporate identity"
  include_role:
    name: utils-srv-corporate-identity
  when: ('corporate_identity' | application_allowed(group_names, allowed_applications))

- name: setup redirect hosts
  when: ('redirect' | application_allowed(group_names, allowed_applications))
  include_role:
    name: web-redirect-domains
  vars:
    domain_mappings: "{{ current_play_domain_mappings_redirect}}"

- name: setup www redirect 
  when: ('www_redirect' | application_allowed(group_names, allowed_applications))
  include_role:
    name: web-redirect-www