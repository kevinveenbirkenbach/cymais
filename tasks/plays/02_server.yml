---
- name: servers host setup
  when: ("servers" in group_names)
  include_role:
    name: "{{ item }}"
  loop:
    - system-security
    - journalctl
    - health-disc-space
    - cleanup-disc-space
    - health-btrfs
    - system-btrfs-auto-balancer

- name: "Integrate Docker Role includes"
  include_tasks: "./tasks/utils/docker-roles.yml"

# Native Webserver Roles
- name: setup nginx-serve-htmls
  include_role:
    name: nginx-serve-html
  vars:
    domain: "{{primary_domain}}"
  when: ('nginx-serve-htmls' | application_allowed(group_names, allowed_applications))

- name: "setup corporate identity"
  include_role:
    name: persona-corporate
  when: ('corporate_identity' | application_allowed(group_names, allowed_applications))

- name: setup redirect hosts
  when: ('redirect' | application_allowed(group_names, allowed_applications))
  include_role:
    name: nginx-redirect-domains
  vars:
    domain_mappings: "{{ current_play_domain_mappings_redirect}}"

- name: setup www redirect 
  when: ('www_redirect' | application_allowed(group_names, allowed_applications))
  include_role:
    name: nginx-redirect-www