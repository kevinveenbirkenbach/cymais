defaults_domains: >-
  {{ {}
    | add_domain_if_group('akaunting',         'accounting.' ~ primary_domain, group_names)
    | add_domain_if_group('attendize',         'tickets.' ~ primary_domain, group_names)
    | add_domain_if_group('baserow',           'baserow.' ~ primary_domain, group_names)
    | add_domain_if_group('bigbluebutton',     'meet.' ~ primary_domain, group_names)
    | add_domain_if_group('bluesky',           {'web': 'bskyweb.' ~ primary_domain,'api':'bluesky.' ~ primary_domain}, group_names)
    | add_domain_if_group('discourse',         'forum.' ~ primary_domain, group_names)
    | add_domain_if_group('elk',               'elk.' ~ primary_domain, group_names)
    | add_domain_if_group('espocrm',           'espocrm.' ~ primary_domain, group_names)
    | add_domain_if_group('file_server',       'files.' ~ primary_domain, group_names)
    | add_domain_if_group('friendica',         'friendica.' ~ primary_domain, group_names)
    | add_domain_if_group('funkwhale',         'music.' ~ primary_domain, group_names)
    | add_domain_if_group('gitea',             'git.' ~ primary_domain, group_names)
    | add_domain_if_group('gitlab',            'gitlab.' ~ primary_domain, group_names)
    | add_domain_if_group('html_server',       'html.' ~ primary_domain, group_names)
    | add_domain_if_group('keycloak',          'auth.' ~ primary_domain, group_names)
    | add_domain_if_group('lam',               'lam.' ~ primary_domain, group_names)
    | add_domain_if_group('ldap',              'ldap.' ~ primary_domain, group_names)
    | add_domain_if_group('listmonk',          'newsletter.' ~ primary_domain, group_names)
    | add_domain_if_group('mailu',             'mail.' ~ primary_domain, group_names)
    | add_domain_if_group('mastodon',          ['microblog.' ~ primary_domain], group_names)
    | add_domain_if_group('matomo',            'matomo.' ~ primary_domain, group_names)
    | add_domain_if_group('matrix',            {'synapse': 'matrix.' ~ primary_domain, 'element':'element.' ~ primary_domain}, group_names)
    | add_domain_if_group('moodle',            'academy.' ~ primary_domain, group_names)
    | add_domain_if_group('mediawiki',         'wiki.' ~ primary_domain, group_names)
    | add_domain_if_group('nextcloud',         'cloud.' ~ primary_domain, group_names)
    | add_domain_if_group('openproject',       'project.' ~ primary_domain, group_names)
    | add_domain_if_group('peertube',          ['video.' ~ primary_domain], group_names)
    | add_domain_if_group('pgadmin',           'pgadmin.' ~ primary_domain, group_names)
    | add_domain_if_group('phpmyadmin',        'phpmyadmin.' ~ primary_domain, group_names)
    | add_domain_if_group('phpmyldapadmin',    'phpmyldap.' ~ primary_domain, group_names)
    | add_domain_if_group('pixelfed',          'picture.' ~ primary_domain, group_names)
    | add_domain_if_group('portfolio',          primary_domain, group_names)
    | add_domain_if_group('presentation',      'slides.' ~ primary_domain, group_names)
    | add_domain_if_group('roulette-wheel',    'roulette.' ~ primary_domain, group_names)
    | add_domain_if_group('snipe_it',          'inventory.' ~ primary_domain, group_names)
    | add_domain_if_group('sphinx',            'docs.' ~ primary_domain, group_names)
    | add_domain_if_group('syncope',           'syncope.' ~ primary_domain, group_names)
    | add_domain_if_group('taiga',             'kanban.' ~ primary_domain, group_names)
    | add_domain_if_group('yourls',            's.' ~ primary_domain, group_names)
    | add_domain_if_group('wordpress',         ['blog.' ~ primary_domain], group_names)
  }}

defaults_redirect_domain_mappings: >-
  {{ []
     | add_redirect_if_group('akaunting',       "akaunting." ~ primary_domain,   domains.akaunting,     group_names)
     | add_redirect_if_group('bigbluebutton',   "bbb." ~ primary_domain,         domains.bigbluebutton, group_names)
     | add_redirect_if_group('discourse',       "discourse." ~ primary_domain,   domains.discourse,     group_names)
     | add_redirect_if_group('espocrm',         "crm." ~ primary_domain,         domains.espocrm,       group_names)
     | add_redirect_if_group('funkwhale',       "funkwhale." ~ primary_domain,   domains.funkwhale,     group_names)
     | add_redirect_if_group('gitea',           "gitea." ~ primary_domain,       domains.gitea,         group_names)
     | add_redirect_if_group('keycloak',        "keycloak." ~ primary_domain,    domains.keycloak,      group_names)
     | add_redirect_if_group('lam',             domains.ldap,                    domains.lam,           group_names)
     | add_redirect_if_group('phpmyldapadmin',  domains.ldap,                    domains.phpmyldapadmin,group_names)
     | add_redirect_if_group('listmonk',        "listmonk." ~ primary_domain,    domains.listmonk,      group_names)
     | add_redirect_if_group('mailu',           "mailu." ~ primary_domain,       domains.mailu,         group_names)
     | add_redirect_if_group('mastodon',        "mastodon." ~ primary_domain,    domains.mastodon[0],   group_names)
     | add_redirect_if_group('moodle',          "moodle." ~ primary_domain,      domains.moodle,        group_names)
     | add_redirect_if_group('nextcloud',       "nextcloud." ~ primary_domain,   domains.nextcloud,     group_names)
     | add_redirect_if_group('openproject',     "openproject." ~ primary_domain, domains.openproject,   group_names)
     | add_redirect_if_group('peertube',        "peertube." ~ primary_domain,    domains.peertube[0],   group_names)
     | add_redirect_if_group('pixelfed',        "pictures." ~ primary_domain,    domains.pixelfed,      group_names)
     | add_redirect_if_group('pixelfed',        "pixelfed." ~ primary_domain,    domains.pixelfed,      group_names)
     | add_redirect_if_group('yourls',          "short." ~ primary_domain,       domains.yourls,        group_names)
     | add_redirect_if_group('snipe-it',        "snipe-it." ~ primary_domain,    domains.snipe_it,      group_names)
     | add_redirect_if_group('taiga',           "taiga." ~ primary_domain,       domains.taiga,         group_names)
     | add_redirect_if_group('peertube',        "videos." ~ primary_domain,      domains.peertube[0],   group_names)
     | add_redirect_if_group('wordpress',       "wordpress." ~ primary_domain,   domains.wordpress[0],  group_names)
  }}

# Domains which are deprecated and should be cleaned up
deprecated_domains: []