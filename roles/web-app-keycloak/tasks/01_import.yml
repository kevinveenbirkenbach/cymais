- name: "load variables from {{ DOCKER_VARS_FILE }}"
  include_vars: "{{ DOCKER_VARS_FILE }}"

- name: Set the directory to which keycloack import files will be copied on host
  set_fact: 
    keycloak_host_import_directory:   "{{ docker_compose.directories.volumes }}import/"

- name: "create directory {{keycloak_host_import_directory}}"
  file:
    path: "{{keycloak_host_import_directory}}"
    state: directory
    mode: 0755

- name: "Copy import files to {{ keycloak_host_import_directory }}"
  template:
    src: "{{ item }}"
    dest: "{{ keycloak_host_import_directory }}/{{ item | basename | regex_replace('\\.j2$', '') }}"
    mode: '770'
  loop: "{{ lookup('fileglob', '{{ role_path }}/templates/import/*.j2', wantlist=True) }}"