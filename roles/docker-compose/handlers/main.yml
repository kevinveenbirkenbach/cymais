---
- name: rebuild docker repository
  command:
    cmd:   docker compose build
    chdir: "{{docker_repository_path}}"
  environment:
    COMPOSE_HTTP_TIMEOUT: 600
    DOCKER_CLIENT_TIMEOUT: 600

# default setup for docker compose files
- name: docker compose up
  shell: docker-compose -p {{ application_id }} up -d --force-recreate --remove-orphans --build
  args:
    chdir: "{{ docker_compose.directories.instance }}"
    executable: /bin/bash
  environment:
    COMPOSE_HTTP_TIMEOUT: 600
    DOCKER_CLIENT_TIMEOUT: 600
  listen: docker compose up

- name: docker compose restart
  command:
    cmd: "docker compose restart"
    chdir: "{{docker_compose.directories.instance}}"
  listen: docker compose restart
