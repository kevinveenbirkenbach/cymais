# @See https://docs.nextcloud.com/server/latest/admin_manual/configuration_user/user_auth_ldap.html
# @See https://chatgpt.com/c/67aa2d21-cb4c-800f-b1be-8629b6bd3f55
# @todo implement
- name: Load LDAP Nextcloud configuration variables
  include_vars:
    file: ldap.yml

- name: Set Nextcloud LDAP config
  loop: "{{ nextcloud_ldap_configuration }}"
  command: >
    docker exec -u www-data {{ applications.nextcloud.container.application }}
    php occ config:app:set {{ item.appid }} {{ item.configkey }} --value "{{ item.configvalue }}"

- name: Set Nextcloud LDAP bind password
  command: >
    docker exec -u www-data {{ applications.nextcloud.container.application }}
    php occ ldap:set-config s01 ldapAgentPassword "{{ ldap.bind_credential }}"
