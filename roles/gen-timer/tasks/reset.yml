- name: Find all cymais.timer units
  find:
    paths: /etc/systemd/system
    patterns: '*.cymais.timer'
  register: cymais_timers

- name: Disable and stop each cymais timer
  systemd:
    name: "{{ item.path | basename }}"
    enabled: no
    state: stopped
  loop: "{{ cymais_timers.files }}"
  loop_control:
    label: "{{ item.path | basename }}"

- name: Remove all cymais.timer files
  file:
    path: "{{ item.path }}"
    state: absent
  loop: "{{ cymais_timers.files }}"
  loop_control:
    label: "{{ item.path | basename }}"

- name: Reload systemd daemon
  command: systemctl daemon-reload
  become: true
