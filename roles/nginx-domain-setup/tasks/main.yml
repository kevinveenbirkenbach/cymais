- name: "include role nginx-modifier-all for {{domain}}"
  include_role: 
    name: nginx-modifier-all

- name: "Relevant variables for role: {{ role_path | basename }}"
  debug:
    msg:
      domain:       "{{domain}}"
      domains:      "{{domains}}"
      applications: "{{applications}}"
  when: enable_debug | bool

- name: "include role nginx-https-recieve-certificate for {{domain}}"
  include_role: 
    name: nginx-https-recieve-certificate

- name: "copy nginx domain configuration to {{configuration_destination}}"
  template: 
    src:  "roles/nginx-docker-reverse-proxy/templates/domain.conf.j2" 
    dest: "{{configuration_destination}}"
  notify: restart nginx
  
- name: "include the docker-oauth2-proxy role {{domain}}"
  include_role:
    name: docker-oauth2-proxy
  when: applications | get_oauth2_enabled(application_id)